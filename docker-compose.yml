cassandra-01: 
  container_name: cassandra-01
  image: raimille1/spark-cassandra:cass-2.1.12
  mem_limit: 2200000000
  environment:
    - CASSANDRA_CLUSTER_NAME=Foxtrot C*
    - CASSANDRA_DC=DC1
    - CASSANDRA_RACK=RACK1
    - CASSANDRA_ENDPOINT_SNITCH=GossipingPropertyFileSnitch
    - MAX_HEAP_SIZE=2G
    - HEAP_NEWSIZE=1G
  volumes:
    - /data/cassandra-01:/var/lib/cassandra
  ports:
    - "9042:9042"
  restart: always

cassandra-02: 
  container_name: cassandra-02
  image: raimille1/spark-cassandra:cass-2.1.12
  mem_limit: 2200000000
  environment:
    - CASSANDRA_CLUSTER_NAME=Foxtrot C*
    - CASSANDRA_DC=DC1
    - CASSANDRA_RACK=RACK1
    - CASSANDRA_ENDPOINT_SNITCH=GossipingPropertyFileSnitch
    - MAX_HEAP_SIZE=2G
    - HEAP_NEWSIZE=1G
    - CASSANDRA_SEEDS=cassandra-01
  volumes:
    - /data/cassandra-02:/var/lib/cassandra
  restart: always

kafka:
  container_name: kafkahost
  image: raimille1/spark-cassandra:kafka-0.9.0.0
  ports:
    - "2181:2181"
    - "9092:9092"
  environment:
    - ADVERTISED_HOST=kafkahost
    - ADVERTISED_PORT=9092
  restart: always

spark-master:
  container_name: sparkmaster
  hostname: sparkmaster
  mem_limit: 1500000000
  environment:
    - SPARK_MASTER_HOST=sparkmaster
  image: raimille1/spark-cassandra:spark-1.6.0-scala-2.11
  command: /usr/local/bin/start master
  ports:
    - "4040:4040"
    - "6066:6066"
    - "7077:7077"
    - "8080:8080"
  restart: always

spark-worker:
  image: raimille1/spark-cassandra:spark-1.6.0-scala-2.11
  command: /usr/local/bin/start worker
  mem_limit: 2500000000
  environment:
    - SPARK_MASTER_ENV_SPARK_MASTER_PORT=7077
  restart: always

# Monitoring 
opscenter:
  container_name: opscenter
  image: raimille1/spark-cassandra:opscenter-5.2.2
  ports:
    - "8888:8888"
  restart: always

cadvisor:
  container_name: cadvisor
  image: google/cadvisor:latest
  volumes: 
    - /:/rootfs:ro
    - /var/run:/var/run:rw
    - /sys:/sys:ro
    - /var/lib/docker/:/var/lib/docker:ro
  ports:
    - "8889:8080"
